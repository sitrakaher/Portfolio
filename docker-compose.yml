services:
  # ── Frontend – Next.js ───────────────────
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_API_URL: http://localhost:4000/api
    container_name: portfolio_frontend
    ports:
      - "3000:3000"
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:4000/api
    depends_on:
      - backend
    networks:
      - portfolio_net

  # ── Backend – Node.js / Express / Prisma ─
  backend:
    build:
      context: ./backendPortfolio
      dockerfile: Dockerfile
      args:
        DATABASE_URL: ${DATABASE_URL}
        JWT_SECRET: ${JWT_SECRET}
    container_name: portfolio_backend
    ports:
      - "4000:4000"
    environment:
      - NODE_ENV=development
      - PORT=4000
      # ⚠️  Remplace par ton vrai MongoDB Atlas URI (ou via .env)
      - DATABASE_URL=${DATABASE_URL}
      - JWT_SECRET=${JWT_SECRET}
    env_file:
      - ./backendPortfolio/.env
    networks:
      - portfolio_net

networks:
  portfolio_net:
    driver: bridge